<html>
    <head>
        <META NAME="viewport" CONTENT="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
        <META HTTP-EQUIV="Content-type" CONTENT="text/html; charset=UTF-8" />
        <link href="css/matostyles.css" rel="old stylesheet" type="text/css" />
        <script type="text/javascript" src="js/luna.js" ></script>
        <style>
            body {
                width: 100%;
                height: 100%;
                background-color: black;
                color: white;
            }
            .luna {
                background-image: url(img/luna.jpg);
                background-size: contain;
                width: 200px;
                height: 200px;
                background-position: center;
                background-repeat: no-repeat;
                margin: auto;
            }
        </style>
        <script>
            var luna = new Luna();
            
            (function(){
                luna.onReady(function(){
                
                    var webview = luna.getMainWebview();
                    var yahoowb;

                    luna.debug( "webview id: " + webview.getID() );

                    var lunawin = apollo11.getElement( "luna","id" );

                    lunawin.addEventListener( "click", function() {
                        apollo11.getElement( "hide", "id" ).click();
                        webview.setProperty( {frame: {
                            height:   320,
                            y:        0
                          },
                          opacity:0.0
                        }, { duration:1.0, delay:0 } ).then(function(result){
                          luna.debug( "webview.setProperty: " + result );
                          webview.close()
                        });
                    });

                    apollo11.getElement( "hide", "id" ).addEventListener( "click", function(){
                        if( yahoowb ) {
                            yahoowb.setProperty( {frame: {
                                height:   320,
                                y:        0
                              },
                              opacity:0.0
                            }, { duration:0.5, delay:0 } ).then(function(result){
                              yahoowb.close();
                            });
                        }
                    });

                    apollo11.getElement( "show", "id" ).addEventListener( "click", function(){
                        luna.getHtmlFile({
                            path:       "https://www.yahoo.com",
                            path_type:  "url"
                        }).then( function( html_file ) {
                          
                            luna.getNewWebview({
                                html_file: html_file,
                                property: {
                                    frame: {
                                        height:   320,
                                        y:        0
                                    },
                                    opacity:    0
                                }
                            }).then( function( result ){
                                apollo11.getElement( "hide", "id" ).click();

                                yahoowb = result

                                luna.debug( "luna.getNewWebview: " + yahoowb.getID() );

                                yahoowb.onLoading(function(progress){
                                    luna.debug( "Loading: " + progress + "%" );
                                });

                                yahoowb.onLoaded().then(function(result){
                                    luna.debug( "webview.onLoaded: " + result );

                                    yahoowb.setProperty( {
                                        frame: {
                                            height:   320,
                                            y:        420
                                        },
                                        opacity:1.0
                                    },
                                    { duration:1.0, delay:0 }).then( function(result){
                                        luna.debug( "webview.setProperty: " + result );
                                    });

                                });

                                yahoowb.load().then(function(result){
                                  luna.debug( "webview.load: " + result );
                                });

                                },function(error){
                                    luna.debug( error )
                                });

                            }, function(error) {
                                luna.debug( "something went wrong" )
                            }
                        );
                        luna.debug( "showtime" );
                    });



                });
             })();
        </script>
    </head>
    <body>
        <article>
            <div id="luna" class="luna"></div>
            <div>Pitch: <span id="pitch">0</span></div>
            <div>Roll: <span id="roll">0</span></div>
            <div>Yaw: <span id="yaw">0</span></div>
            <ul class="flex-box">
                <li><div id="show" class="custom-button">NEW WEBVIEW SITE</div></li>
                <li><div id="hide" class="custom-button">HIDE WEBVIEW SITE</div></li>
            </ul>
        </article>
    </body>
</html>

